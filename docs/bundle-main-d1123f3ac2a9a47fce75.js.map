{"version":3,"sources":["webpack://Demo/./node_modules/decode-uri-component/index.js","webpack://Demo/./node_modules/filter-obj/index.js","webpack://Demo/./node_modules/performance-now/lib/performance-now.js","webpack://Demo/./node_modules/query-string/index.js","webpack://Demo/./node_modules/split-on-first/index.js","webpack://Demo/./node_modules/strict-uri-encode/index.js","webpack://Demo/webpack/bootstrap","webpack://Demo/webpack/runtime/compat get default export","webpack://Demo/webpack/runtime/define property getters","webpack://Demo/webpack/runtime/hasOwnProperty shorthand","webpack://Demo/webpack/runtime/make namespace object","webpack://Demo/./src/Color.js","webpack://Demo/./src/index.js","webpack://Demo/./src/rm-08.vert","webpack://Demo/./src/rm-08.frag"],"names":["token","singleMatcher","RegExp","multiMatcher","decodeComponents","components","split","decodeURIComponent","join","err","length","left","slice","right","Array","prototype","concat","call","decode","input","tokens","match","i","module","exports","encodedURI","TypeError","replace","replaceMap","exec","result","entries","Object","keys","key","customDecodeURIComponent","obj","predicate","ret","isArr","isArray","val","indexOf","getNanoSeconds","hrtime","loadTime","moduleLoadTime","nodeLoadTime","upTime","performance","now","process","hr","uptime","Date","getTime","this","strictUriEncode","decodeComponent","splitOnFirst","filterObject","validateArrayFormatSeparator","value","encode","options","strict","encodeURIComponent","keysSorter","sort","a","b","Number","map","removeHash","hashStart","extract","queryStart","parseValue","parseNumbers","isNaN","trim","parseBooleans","toLowerCase","parse","query","assign","arrayFormat","arrayFormatSeparator","formatter","accumulator","undefined","includes","isEncodedArray","newValue","item","test","arrayValue","parserForArrayFormat","create","param","k","reduce","Boolean","stringify","object","shouldFilter","skipNull","skipEmptyString","index","keyValueSep","encoderForArrayFormat","objectCopy","filter","x","parseUrl","url","url_","hash","parseFragmentIdentifier","fragmentIdentifier","stringifyUrl","queryFromUrl","parsedQueryFromUrl","queryString","getHash","pick","exclude","exclusionFilter","string","separator","separatorIndex","str","charCodeAt","toString","toUpperCase","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","n","getter","__esModule","d","definition","o","defineProperty","enumerable","get","prop","hasOwnProperty","r","Symbol","toStringTag","colorRegExp","hex","s","hue2rgb","p","q","t","canvas","gl","vao","program","u_time","u_symmetry","u_resolution","u_mouse","u_palette","u_shiny","u_env","u_env_ref","mouseDown","startX","startY","canvasBounds","envTexture","envTextureRef","Color","g","color","m","col","parseInt","substring","factor","array","Float32Array","f","off","from","validate","Error","h","l","Math","round","other","ratio","out","config","sqrt","PI","width","height","mouseX","mouseY","sym","location","search","resize","window","innerWidth","innerHeight","viewport","createShader","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","deleteShader","main","time","uniform1f","perfNow","uniform2f","uniform4f","clearColor","clear","COLOR_BUFFER_BIT","primitiveType","TRIANGLES","drawArrays","requestAnimationFrame","onMouseMove","ev","clientX","self","pageXOffset","clientY","top","pageYOffset","onMouseDown","onMouseUp","onload","document","getElementById","getContext","parentNode","removeChild","innerHTML","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","positionAttributeLocation","getAttribLocation","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","createVertexArray","bindVertexArray","enableVertexAttribArray","FLOAT","vertexAttribPointer","createTexture","envImage","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","generateMipmap","envImageRef","getUniformLocation","useProgram","addEventListener","control","setAttribute","String","target","getBoundingClientRect","paletteArray","uniform3fv","uniform1fv","activeTexture","TEXTURE0","uniform1i","TEXTURE1"],"mappings":"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","file":"bundle-main-d1123f3ac2a9a47fce75.js","sourcesContent":["'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n","'use strict';\nmodule.exports = function (obj, predicate) {\n\tvar ret = {};\n\tvar keys = Object.keys(obj);\n\tvar isArr = Array.isArray(predicate);\n\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tvar key = keys[i];\n\t\tvar val = obj[key];\n\n\t\tif (isArr ? predicate.indexOf(key) !== -1 : predicate(key, val, obj)) {\n\t\t\tret[key] = val;\n\t\t}\n\t}\n\n\treturn ret;\n};\n","// Generated by CoffeeScript 1.12.2\n(function() {\n  var getNanoSeconds, hrtime, loadTime, moduleLoadTime, nodeLoadTime, upTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - nodeLoadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    moduleLoadTime = getNanoSeconds();\n    upTime = process.uptime() * 1e9;\n    nodeLoadTime = moduleLoadTime - upTime;\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n//# sourceMappingURL=performance-now.js.map\n","'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\nconst filterObject = require('filter-obj');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\tcase 'bracket-separator': {\n\t\t\tconst keyValueSep = options.arrayFormat === 'bracket-separator' ?\n\t\t\t\t'[]=' :\n\t\t\t\t'=';\n\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\t// Translate null to an empty string so that it doesn't serialize as 'null'\n\t\t\t\tvalue = value === null ? '' : value;\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), keyValueSep, encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n\t\t\t\tconst isEncodedArray = (typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator));\n\t\t\t\tvalue = isEncodedArray ? decode(value, options) : value;\n\t\t\t\tconst newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tcase 'bracket-separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = /(\\[\\])$/.test(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!isArray) {\n\t\t\t\t\taccumulator[key] = value ? decode(value, options) : value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst arrayValue = value === null ?\n\t\t\t\t\t[] :\n\t\t\t\t\tvalue.split(options.arrayFormatSeparator).map(item => decode(item, options));\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = arrayValue;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], arrayValue);\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(query, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof query !== 'string') {\n\t\treturn ret;\n\t}\n\n\tquery = query.trim().replace(/^[?#&]/, '');\n\n\tif (!query) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of query.split('&')) {\n\t\tif (param === '') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : ['comma', 'separator', 'bracket-separator'].includes(options.arrayFormat) ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (value.length === 0 && options.arrayFormat === 'bracket-separator') {\n\t\t\t\treturn encode(key, options) + '[]';\n\t\t\t}\n\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (url, options) => {\n\toptions = Object.assign({\n\t\tdecode: true\n\t}, options);\n\n\tconst [url_, hash] = splitOnFirst(url, '#');\n\n\treturn Object.assign(\n\t\t{\n\t\t\turl: url_.split('?')[0] || '',\n\t\t\tquery: parse(extract(url), options)\n\t\t},\n\t\toptions && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}\n\t);\n};\n\nexports.stringifyUrl = (object, options) => {\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true\n\t}, options);\n\n\tconst url = removeHash(object.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(object.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl, {sort: false});\n\n\tconst query = Object.assign(parsedQueryFromUrl, object.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(object.url);\n\tif (object.fragmentIdentifier) {\n\t\thash = `#${encode(object.fragmentIdentifier, options)}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n\nexports.pick = (input, filter, options) => {\n\toptions = Object.assign({\n\t\tparseFragmentIdentifier: true\n\t}, options);\n\n\tconst {url, query, fragmentIdentifier} = exports.parseUrl(input, options);\n\treturn exports.stringifyUrl({\n\t\turl,\n\t\tquery: filterObject(query, filter),\n\t\tfragmentIdentifier\n\t}, options);\n};\n\nexports.exclude = (input, filter, options) => {\n\tconst exclusionFilter = Array.isArray(filter) ? key => !filter.includes(key) : (key, value) => !filter(key, value);\n\n\treturn exports.pick(input, exclusionFilter, options);\n};\n","'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n","'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const colorRegExp = /^(#)?([0-9a-f]+)$/i;\n\nfunction hex(n)\n{\n    const s = n.toString(16);\n\n    return s.length === 1 ? \"0\" + s : s;\n}\n\nfunction hue2rgb(p, q, t){\n    if(t < 0) t += 1;\n    if(t > 1) t -= 1;\n    if(t < 1/6) return p + (q - p) * 6 * t;\n    if(t < 1/2) return q;\n    if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n    return p;\n}\n\nexport default class Color\n{\n    r;\n    g;\n    b;\n\n    constructor(r,g,b)\n    {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n\n    mix(other, ratio, out)\n    {\n        if (!out)\n        {\n            out = new Color();\n        }\n        out.r = (this.r + (other.r - this.r) * ratio)|0;\n        out.g = (this.g + (other.g - this.g) * ratio)|0;\n        out.b = (this.b + (other.b - this.b) * ratio)|0;\n\n        return out;\n    }\n\n    multiply(n, out)\n    {\n        if (!out)\n        {\n            out = new Color();\n        }\n\n        out.r = this.r * n;\n        out.g = this.g * n;\n        out.b = this.b * n;\n        return out;\n    }\n\n    toRGBHex()\n    {\n        return \"#\" + hex(this.r) + hex(this.g) + hex(this.b );\n    }\n\n    toHex()\n    {\n        return (this.r << 16) + (this.g << 8) + this.b;\n    }\n\n    static validate(color)\n    {\n\n        let m;\n        if (typeof color !== \"string\" || !(m = colorRegExp.exec(color)))\n        {\n            return null;\n        }\n        const col = m[2];\n\n        if (col.length === 3)\n        {\n            return new Color(\n                parseInt(col[0], 16) * 17,\n                parseInt(col[1], 16) * 17,\n                parseInt(col[2], 16) * 17\n            )\n        }\n        else if (col.length === 6)\n        {\n            return new Color(\n                parseInt(col.substring(0, 2), 16),\n                parseInt(col.substring(2, 4), 16),\n                parseInt(col.substring(4, 6), 16)\n            )\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    static from(color, factor = 1.0)\n    {\n        if (Array.isArray(color))\n        {\n            const length = color.length;\n            const array = new Float32Array(length * 3);\n\n            const f = factor/255;\n\n            let off = 0;\n            for (let i = 0; i < length; i++)\n            {\n                const col = Color.from(color[i]);\n                array[off++] = col.r * f;\n                array[off++] = col.g * f;\n                array[off++] = col.b * f;\n            }\n\n            return array;\n        }\n\n        const col = Color.validate(color);\n\n        if (!col)\n        {\n            throw new Error(\"Invalid color \" + color);\n        }\n\n        col.r *= factor;\n        col.g *= factor;\n        col.b *= factor;\n\n        return col;\n    }\n\n    static fromHSL(h,s,l)\n    {\n        let r, g, b;\n\n        if(s <= 0){\n            r = g = b = l; // achromatic\n        }else{\n\n            const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n            const p = 2 * l - q;\n            r = hue2rgb(p, q, h + 1/3);\n            g = hue2rgb(p, q, h);\n            b = hue2rgb(p, q, h - 1/3);\n        }\n\n        return new Color(\n            Math.round(r * 255),\n            Math.round(g * 255),\n            Math.round(b * 255)\n        );\n    }\n}\n\n","// noinspection ES6UnusedImports\nimport STYLE from \"./style.css\"\nimport perfNow from \"performance-now\"\nimport queryString from \"query-string\"\n\nimport vertexShaderSource from \"./rm-08.vert\"\nimport fragmentShaderSource from \"./rm-08.frag\"\nimport Color from \"./Color\";\n\n//console.log(fragmentShaderSource)\n\nconst PHI = (1 + Math.sqrt(5)) / 2;\nconst TAU = Math.PI * 2;\nconst DEG2RAD_FACTOR = TAU / 360;\n\nconst config = {\n    width: 0,\n    height: 0\n};\n\nlet canvas, gl, vao, program;\n\n\n// uniform: current time\nlet u_time;\n\nlet u_symmetry;\n\nlet u_resolution;\n\nlet u_mouse;\n\nlet u_palette;\n\nlet u_shiny;\n\nlet u_env;\nlet u_env_ref;\n\nlet mouseX = 0, mouseY = 0, mouseDown, startX, startY;\n\n// Get the container element's bounding box\nlet canvasBounds;\n\nlet envTexture;\nlet envTextureRef;\n\nlet sym = +(queryString.parse(location.search).sym || \"7\");\n\nfunction resize()\n{\n    const width = (window.innerWidth) & ~15;\n    const height = (window.innerHeight) | 0;\n\n    config.width = width;\n    config.height = height;\n\n    canvas.width = width;\n    canvas.height = height;\n\n    mouseX = width/2;\n    mouseY = height/2;\n\n    gl.viewport(0, 0, canvas.width, canvas.height);\n}\n\nfunction createShader(gl, type, source) {\n    const shader = gl.createShader(type);\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n    const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n    if (success) {\n        return shader;\n    }\n\n    console.error(gl.getShaderInfoLog(shader));  // eslint-disable-line\n    gl.deleteShader(shader);\n    return undefined;\n}\n\nfunction createProgram(gl, vertexShader, fragmentShader) {\n    const program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n    if (success) {\n        return program;\n    }\n\n    console.error(gl.getProgramInfoLog(program));  // eslint-disable-line\n    gl.deleteProgram(program);\n    return undefined;\n}\n\n\nfunction printError(msg)\n{\n    document.getElementById(\"out\").innerHTML = \"<p>\" + msg + \"</p>\";\n}\n\n\nfunction main(time)\n{\n    const f = mouseDown ? 1 : -1;\n\n    // update uniforms\n    gl.uniform1f(u_time, perfNow() / 1000.0);\n    gl.uniform1f(u_symmetry, sym);\n    gl.uniform2f(u_resolution, config.width, config.height);\n    gl.uniform4f(u_mouse, mouseX, config.height - mouseY, startX * f, (config.height - startY) * f);\n\n    gl.clearColor(0, 0, 0, 0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    // draw\n    const primitiveType = gl.TRIANGLES;\n    const offset = 0;\n    const count = 6;\n    gl.drawArrays(primitiveType, offset, count);\n\n    requestAnimationFrame(main);\n}\n\n\nwindow.onload = () => {\n    // Get A WebGL context\n    canvas = document.getElementById(\"screen\");\n\n    gl = canvas.getContext(\"webgl2\");\n    if (!gl) {\n        canvas.parentNode.removeChild(canvas);\n        printError(\"Cannot run shader. Your browser does not support WebGL2.\");\n        return;\n    }\n\n\n    // create GLSL shaders, upload the GLSL source, compile the shaders\n    const vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);\n    const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);\n\n    // Link the two shaders into a program\n    program = createProgram(gl, vertexShader, fragmentShader);\n\n    // look up where the vertex data needs to go.\n    const positionAttributeLocation = gl.getAttribLocation(program, \"a_position\");\n\n    // Create a buffer and put three 2d clip space points in it\n    const positionBuffer = gl.createBuffer();\n\n    // Bind it to ARRAY_BUFFER (think of it as ARRAY_BUFFER = positionBuffer)\n    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n\n    const positions = [\n        -1, -1,\n         1, -1,\n        -1, 1,\n        -1, 1,\n         1, 1,\n         1,-1\n    ];\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\n\n    // Create a vertex array object (attribute state)\n    vao = gl.createVertexArray();\n\n    // and make it the one we're currently working with\n    gl.bindVertexArray(vao);\n\n    // Turn on the attribute\n    gl.enableVertexAttribArray(positionAttributeLocation);\n\n    // Tell the attribute how to get data out of positionBuffer (ARRAY_BUFFER)\n    const size = 2;          // 2 components per iteration\n    const type = gl.FLOAT;   // the data is 32bit floats\n    const normalize = false; // don't normalize the data\n    const stride = 0;        // 0 = move forward size * sizeof(type) each iteration to get the next position\n    let offset = 0;        // start at the beginning of the buffer\n    gl.vertexAttribPointer(\n        positionAttributeLocation, size, type, normalize, stride, offset);\n\n\n    resize();\n\n    // Tell WebGL how to convert from clip space to pixels\n    //gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n    //gl.enable(gl.TEXTURE_2D);\n    envTexture = gl.createTexture();\n\n    const envImage = document.getElementById(\"env\");\n\n    gl.bindTexture(gl.TEXTURE_2D, envTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2048, 1024, 0, gl.RGBA, gl.UNSIGNED_BYTE, envImage);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    gl.generateMipmap(gl.TEXTURE_2D);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    const envImageRef = document.getElementById(\"env-ref\");\n\n    envTextureRef = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, envTextureRef);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2048, 1024, 0, gl.RGBA, gl.UNSIGNED_BYTE, envImageRef);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    gl.generateMipmap(gl.TEXTURE_2D);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n\n    u_time = gl.getUniformLocation(program, \"u_time\");\n    u_symmetry = gl.getUniformLocation(program, \"u_symmetry\");\n    u_resolution = gl.getUniformLocation(program, \"u_resolution\");\n    u_mouse = gl.getUniformLocation(program, \"u_mouse\");\n    u_palette = gl.getUniformLocation(program, \"u_palette\");\n    u_shiny = gl.getUniformLocation(program, \"u_shiny\");\n    u_env = gl.getUniformLocation(program, \"u_env\");\n    u_env_ref = gl.getUniformLocation(program, \"u_env_ref\");\n\n    // Tell it to use our program (pair of shaders)\n    gl.useProgram(program);\n\n\n    // Bind the attribute/buffer set we want.\n    gl.bindVertexArray(vao);\n\n    window.addEventListener(\"resize\", resize, true);\n    canvas.addEventListener(\"mousemove\", onMouseMove, true);\n    canvas.addEventListener(\"mousedown\", onMouseDown, true);\n    document.addEventListener(\"mouseup\", onMouseUp, true);\n\n    const control = document.getElementById(\"control\");\n    control.setAttribute(\"value\", String(sym));\n    control.addEventListener(\"change\", ev =>  sym = +ev.target.value, true);\n\n\n\n    window.addEventListener(\"touchstart\", onMouseDown, true)\n    window.addEventListener(\"touchmove\", onMouseMove, true)\n    window.addEventListener(\"touchend\", onMouseUp, true)\n\n    canvasBounds = document.getElementById(\"screen\").getBoundingClientRect();\n\n    const paletteArray = Color.from(\n        [\n            \"#010101\",                          \n            \"#fff\",\n            \"#fff\",\n            \"#0081ff\",\n            \"#ff0082\",\n            \"#fff\",\n            \"#f0f\",\n            \"#0f0\"\n        ],\n        1\n    );\n\n\n    gl.uniform3fv(u_palette, paletteArray);\n    gl.uniform1fv(u_shiny, new Float32Array([\n        10,\n        10,\n        10,\n        10,\n        10,\n        10,\n        10,\n        10\n    ]));\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, envTexture);\n    gl.uniform1i(u_env, 0);\n\n    gl.activeTexture(gl.TEXTURE1);\n    gl.bindTexture(gl.TEXTURE_2D, envTextureRef);\n    gl.uniform1i(u_env_ref, 1);\n\n    requestAnimationFrame(main)\n}\n\n\n// Apply the mouse event listener\n\nfunction onMouseMove(ev)\n{\n    if (mouseDown)\n    {\n        mouseX = (ev.clientX - canvasBounds.left) + self.pageXOffset;\n        mouseY = (ev.clientY - canvasBounds.top) + self.pageYOffset;\n    }\n}\n\nfunction onMouseDown(ev)\n{\n    mouseDown = true;\n    startX = (ev.clientX - canvasBounds.left) + self.pageXOffset;\n    startY = (ev.clientY - canvasBounds.top) + self.pageYOffset;\n    mouseX = startX;\n    mouseY = startY;\n}\n\nfunction onMouseUp(ev)\n{\n    mouseDown = false;\n}\n\n","export default \"#version 300 es\\n#define GLSLIFY 1\\n\\n// an attribute is an input (in) to a vertex shader.\\n// It will receive data from a buffer\\nin vec4 a_position;\\n\\n// all shaders have a main function\\nvoid main() {\\n\\n    // gl_Position is a special variable a vertex shader\\n    // is responsible for setting\\n    gl_Position = a_position;\\n}\\n\";","export default \"#version 300 es\\nprecision highp float;\\n#define GLSLIFY 1\\n\\nuniform float u_time;\\nuniform float u_symmetry;\\n\\nuniform vec2 u_resolution;\\nuniform vec4 u_mouse;\\nuniform vec3 u_palette[8];\\nuniform float u_shiny[8];\\nuniform sampler2D u_env;\\nuniform sampler2D u_env_ref;\\n\\nconst float pi = 3.141592653589793;\\nconst float tau = pi * 2.0;\\nconst float invTau = 1.0 / tau;\\nconst float hpi = pi * 0.5;\\nconst float phi = (1.0+sqrt(5.0))/2.0;\\n\\nvec3 toLinearFactor = vec3(2.2);\\nvec3 toRGBFactor = vec3(1./2.2);\\n\\nout vec4 outColor;\\n\\nstruct opts {\\n    float dummy;\\n};\\n\\n#define MAX_STEPS 200\\n#define MAX_DIST 1000.\\n#define SURF_DIST .001\\n\\n#define ROT(a) mat2(cos(a), -sin(a), sin(a), cos(a))\\n#define SHEARX(a) mat2(1, 0, sin(a), 1)\\n\\n////////////////////// NOISE\\n\\n//\\tSimplex 3D Noise\\n//\\tby Ian McEwan, Ashima Arts\\n//\\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\\n\\nfloat snoise(vec3 v){\\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\\n\\n    // First corner\\n    vec3 i  = floor(v + dot(v, C.yyy) );\\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\\n\\n    // Other corners\\n    vec3 g = step(x0.yzx, x0.xyz);\\n    vec3 l = 1.0 - g;\\n    vec3 i1 = min( g.xyz, l.zxy );\\n    vec3 i2 = max( g.xyz, l.zxy );\\n\\n    //  x0 = x0 - 0. + 0.0 * C\\n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\\n\\n    // Permutations\\n    i = mod(i, 289.0 );\\n    vec4 p = permute( permute( permute(\\n    i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\\n    + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\\n    + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\\n\\n    // Gradients\\n    // ( N*N points uniformly over a square, mapped onto an octahedron.)\\n    float n_ = 1.0/7.0; // N=7\\n    vec3  ns = n_ * D.wyz - D.xzx;\\n\\n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\\n\\n    vec4 x_ = floor(j * ns.z);\\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\\n\\n    vec4 x = x_ *ns.x + ns.yyyy;\\n    vec4 y = y_ *ns.x + ns.yyyy;\\n    vec4 h = 1.0 - abs(x) - abs(y);\\n\\n    vec4 b0 = vec4( x.xy, y.xy );\\n    vec4 b1 = vec4( x.zw, y.zw );\\n\\n    vec4 s0 = floor(b0)*2.0 + 1.0;\\n    vec4 s1 = floor(b1)*2.0 + 1.0;\\n    vec4 sh = -step(h, vec4(0.0));\\n\\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\\n\\n    vec3 p0 = vec3(a0.xy,h.x);\\n    vec3 p1 = vec3(a0.zw,h.y);\\n    vec3 p2 = vec3(a1.xy,h.z);\\n    vec3 p3 = vec3(a1.zw,h.w);\\n\\n    //Normalise gradients\\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\\n    p0 *= norm.x;\\n    p1 *= norm.y;\\n    p2 *= norm.z;\\n    p3 *= norm.w;\\n\\n    // Mix final noise value\\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\\n    m = m * m;\\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\\n    dot(p2,x2), dot(p3,x3) ) );\\n}\\n\\nfloat rand(float n){return fract(sin(n) * 43758.5453123);}\\n\\n// Camera helper\\n\\nvec3 Camera(vec2 uv, vec3 p, vec3 l, float z) {\\n    vec3 f = normalize(l-p),\\n    r = normalize(\\n    cross(\\n    vec3(0, 1, 0),\\n    f\\n    )\\n    ),\\n    u = cross(f, r),\\n    c = p + f * z,\\n    i = c + uv.x*r + uv.y*u,\\n    d = normalize(i-p);\\n    return d;\\n}\\n\\n// 2d rotation matrix helper\\nmat2 Rot(float a) {\\n    float x = cos(a);\\n    float y = sin(a);\\n    return mat2(x, -y, y, x);\\n}\\n\\n// RAY MARCHING PRIMITIVES\\n\\nfloat smin(float a, float b, float k) {\\n    float h = clamp(0.5+0.5*(b-a)/k, 0., 1.);\\n    return mix(b, a, h) - k*h*(1.0-h);\\n}\\n\\nfloat sdCapsule(vec3 p, vec3 a, vec3 b, float r) {\\n    vec3 ab = b-a;\\n    vec3 ap = p-a;\\n\\n    float t = dot(ab, ap) / dot(ab, ab);\\n    t = clamp(t, 0., 1.);\\n\\n    vec3 c = a + t*ab;\\n\\n    return length(p-c)-r;\\n}\\n\\nfloat sdCylinder(vec3 p, vec3 a, vec3 b, float r) {\\n    vec3 ab = b-a;\\n    vec3 ap = p-a;\\n\\n    float t = dot(ab, ap) / dot(ab, ab);\\n    //t = clamp(t, 0., 1.);\\n\\n    vec3 c = a + t*ab;\\n\\n    float x = length(p-c)-r;\\n    float y = (abs(t-.5)-.5)*length(ab);\\n    float e = length(max(vec2(x, y), 0.));\\n    float i = min(max(x, y), 0.);\\n\\n    return e+i;\\n}\\n\\nfloat sdCappedCylinder( vec3 p, float h, float r )\\n{\\n    vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(h,r);\\n    return min(max(d.x,d.y),0.0) + length(max(d,0.0));\\n}\\n\\nfloat sdSphere(vec3 p, float s)\\n{\\n    return length(p)-s;\\n}\\n\\nfloat sdTorus(vec3 p, vec2 r) {\\n    float x = length(p.xz)-r.x;\\n    return length(vec2(x, p.y))-r.y;\\n}\\n\\nfloat sdRoundBox(vec3 p, vec3 b, float r)\\n{\\n    vec3 q = abs(p) - b;\\n    return length(max(q, 0.0)) + min(max(q.x, max(q.y, q.z)), 0.0) - r;\\n}\\n\\nfloat sdBeam(vec3 p, vec3 c)\\n{\\n    return length(p.xz-c.xy)-c.z;\\n}\\n\\nfloat dBox(vec3 p, vec3 s) {\\n    p = abs(p)-s;\\n    return length(max(p, 0.))+min(max(p.x, max(p.y, p.z)), 0.);\\n}\\n\\nvec2 opUnion(vec2 curr, float d, float id)\\n{\\n    if (d < curr.x)\\n    {\\n        curr.x = d;\\n        curr.y = id;\\n    }\\n\\n    return curr;\\n}\\n\\nvec2 softMinUnion(vec2 curr, float d, float id)\\n{\\n    float nx = smin(curr.x, d, 0.5);\\n    if (nx < curr.x)\\n    {\\n        curr.x = nx;\\n        curr.y = id;\\n    }\\n\\n    return curr;\\n}\\n\\nfloat sdBoundingBox(vec3 p, vec3 b, float e)\\n{\\n    p = abs(p)-b;\\n    vec3 q = abs(p+e)-e;\\n    return min(min(\\n    length(max(vec3(p.x, q.y, q.z), 0.0))+min(max(p.x, max(q.y, q.z)), 0.0),\\n    length(max(vec3(q.x, p.y, q.z), 0.0))+min(max(q.x, max(p.y, q.z)), 0.0)),\\n    length(max(vec3(q.x, q.y, p.z), 0.0))+min(max(q.x, max(q.y, p.z)), 0.0));\\n}\\n\\nfloat sdHexPrism( vec3 p, vec2 h )\\n{\\n    const vec3 k = vec3(-0.8660254, 0.5, 0.57735);\\n    p = abs(p);\\n    p.xy -= 2.0*min(dot(k.xy, p.xy), 0.0)*k.xy;\\n    vec2 d = vec2(\\n    length(p.xy-vec2(clamp(p.x,-k.z*h.x,k.z*h.x), h.x))*sign(p.y-h.x),\\n    p.z-h.y );\\n    return min(max(d.x,d.y),0.0) + length(max(d,0.0));\\n}\\n\\nfloat shape(float v, float x)\\n{\\n    return x > 0.0 ? -abs(v) : abs(v);\\n}\\n\\nconst mat2 frontPlaneRot = ROT(0.05235987755982988);\\n\\nconst float sin60 = sin(tau/6.0);\\nvec2 N22 (vec2 p) {\\n    vec3 a = fract(p.xyx*vec3(123.34, 234.34, 345.65));\\n    a += dot(a, a+34.45);\\n    return fract(vec2(a.x*a.y, a.y*a.z));\\n}\\n\\nfloat atan2(in float y, in float x)\\n{\\n    return abs(x) > abs(y) ? hpi - atan(x,y) : atan(y,x);\\n}\\nfloat ndot( in vec2 a, in vec2 b ) { return a.x*b.x - a.y*b.y; }\\n\\nfloat sdRoundedCylinder( vec3 p, float ra, float rb, float h )\\n{\\n    vec2 d = vec2( length(p.xz)-2.0*ra+rb, abs(p.y) - h );\\n    return min(max(d.x,d.y),0.0) + length(max(d,0.0)) - rb;\\n}\\n\\nfloat sdRhombus( in vec2 p, in vec2 b )\\n{\\n    vec2 q = abs(p);\\n    float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\\n    float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\\n    return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\\n}\\n\\nfloat sdBox( vec3 p, vec3 b )\\n{\\n    vec3 q = abs(p) - b;\\n    return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\\n}\\n\\nvec2 getDistance(vec3 p, opts o) {\\n\\n    mat2 rot45 = Rot(tau * 0.125);\\n    mat2 rot37 = Rot(tau * 0.19);\\n\\n    vec3 q = p - vec3( 0,2,0);\\n    q.xy *= rot45;\\n    q.yz *= rot37;\\n\\n    vec2 result = vec2(p.y, 2.0);\\n    result = opUnion(result, sdBox(q, vec3(1.5)) - 0.04, 3.0);\\n    result = opUnion(result, sdTorus(p - vec3( 0,2,0), vec2(4.0, 1.0)), 4.0);\\n    return result;\\n\\n}\\n\\nvec2 rayMarch(vec3 ro, vec3 rd, opts o) {\\n\\n    float dO = 0.;\\n    float id = 0.0;\\n\\n    for (int i=0; i < MAX_STEPS; i++) {\\n        vec3 p = ro + rd*dO;\\n        vec2 result = getDistance(p, o);\\n        float dS = result.x;\\n        dO += dS;\\n        id = result.y;\\n        if (dO > MAX_DIST || abs(dS) < SURF_DIST * 0.001*(dO*.125 + 1.))\\n        break;\\n    }\\n\\n    return vec2(dO, id);\\n}\\n\\n//vec3 getNormal(vec3 p, opts o) {\\n//    float d = getDistance(p, o).x;\\n//    vec2 e = vec2(.01, 0);\\n//\\n//    vec3 n = d - vec3(\\n//    getDistance(p-e.xyy, o).x,\\n//    getDistance(p-e.yxy, o).x,\\n//    getDistance(p-e.yyx, o).x\\n//    );\\n//\\n//    return normalize(n);\\n//}\\n\\nvec3 getNormal(vec3 p, opts o)// for function f(p)\\n{\\n    const float h = 0.0001;// replace by an appropriate value\\n    const vec2 k = vec2(1, -1);\\n    return normalize(k.xyy*getDistance(p + k.xyy*h, o).x +\\n    k.yyx*getDistance(p + k.yyx*h,o).x +\\n    k.yxy*getDistance(p + k.yxy*h,o).x +\\n    k.xxx*getDistance(p + k.xxx*h,o).x);\\n}\\n\\nvec3 getPaletteColor(float id)\\n{\\n    int last = u_palette.length() - 1;\\n    //return id < float(last) ? mix(u_palette[int(id)], u_palette[int(id) + 1], fract(id)) : u_palette[last];\\n    return mix(u_palette[int(id)], u_palette[int(id) + 1], fract(id));\\n}\\n\\nvec3 applyFog(\\nin vec3  rgb,      // original color of the pixel\\nin float distance, // camera to point distance\\nin vec3  rayOri,   // camera position\\nin vec3  rayDir,\\nin vec3 p     // camera to point vector\\n)\\n{\\n    float pos = p.z;\\n\\n    float c = 0.005;\\n    float b = 0.001;// + sin((pos + p.x * sin(pos * 0.27)) * 0.31 ) * 0.15 + sin(pos * 0.17 ) * 0.15;\\n\\n    float fogAmount = c * exp(-rayOri.y*b) * (1.0-exp( -distance*rayDir.y*b ))/rayDir.y;\\n    vec3  fogColor  = vec3(1);\\n    return mix( rgb, fogColor, fogAmount );\\n}\\n\\nfloat softshadow( in vec3 ro, in vec3 rd, float k , opts o)\\n{\\n    float res = 1.0;\\n    float ph = 1e20;\\n    for( float t=0.001; t< MAX_DIST; )\\n    {\\n        float h = getDistance(ro + rd*t, o).x;\\n        if( h < 0.0001 )\\n        return 0.0;\\n\\n        float y = h * h / ( 2.0 * ph );\\n        float d = sqrt( h * h - y * y);\\n        res = min( res, k * d /max(0.0, t -y) );\\n        ph = h;\\n        t += h;\\n    }\\n    return res;\\n}\\n\\nvec3 getBackground(in vec3 n)\\n{\\n    vec3 col = n;// * 0.5 + 0.5;\\n\\n    col = col*col*col*col;\\n\\n    return (mix(vec3(1,0,0), vec3(0,1,0), -n.z) +\\n    mix(vec3(0,0,1), vec3(1,1,0), n.y) +\\n    mix(vec3(0,0,0), vec3(0,1,1), n.x));\\n}\\n\\nvec3 getEnv(in vec3 n, bool ref)\\n{\\n    // Computing longitude\\n    float x = atan( -n.z, -n.x ) * invTau + 0.5;\\n\\n    // Computing latitude\\n    float y = -n.y * 0.5 + 0.5;\\n\\n    if (ref)\\n    {\\n        return texture(u_env_ref, vec2(x,y)).rgb;\\n    }\\n    else\\n    {\\n        return texture(u_env, vec2(x,y)).rgb;\\n    }\\n\\n}\\n\\nvoid main(void)\\n{\\n    const int mirrorLimit = 5;\\n\\n    vec2 ratio = vec2(1, 1);\\n\\n    vec2 uv = vec2(0);\\n    if (u_symmetry == 0.0)\\n    {\\n        uv = (gl_FragCoord.xy * ratio - .5 * u_resolution.xy * ratio)/min(u_resolution.x, u_resolution.y);\\n    }\\n    else\\n    {\\n        float size = min(u_resolution.x, u_resolution.y);\\n\\n        float tx = ((gl_FragCoord.x) / size) * 2.0 - 1.0;\\n        float ty = 1.0 - ((gl_FragCoord.y) / size) * 2.0;\\n\\n        if (u_resolution.x < u_resolution.y)\\n        {\\n            ty -= (u_resolution.y - u_resolution.x) / size;\\n        }\\n        else\\n        {\\n            tx -= (u_resolution.x - u_resolution.y) / size;\\n        }\\n\\n        float a0 = ((atan2(ty,tx) - pi/2.0) / tau) * u_symmetry * 2.0;\\n        float id = floor(a0);\\n        float c = mod(id,2.0);\\n        float a = c - fract(a0) * (c * 2.0 - 1.0);\\n        float dist = sqrt( tx * tx + ty * ty);\\n\\n        float symAngle = tau/(u_symmetry*2.0);\\n\\n        uv = vec2(\\n        cos(a * symAngle) * dist * 0.5,\\n        sin(a * symAngle) * dist * 0.5\\n        );\\n\\n    }\\n\\n    vec2 m = u_mouse.xy/u_resolution.xy;\\n\\n    vec3 ro = vec3(\\n        0,\\n        8.0,\\n        -10.0\\n    );\\n\\n    float rotTime = u_time * 0.05;\\n    float hopTime = u_time * 0.12;\\n\\n    const float minY = -0.2;\\n    const float maxY = 0.26;\\n\\n    const float cy = (minY + maxY) / 2.0;\\n    const float amp = maxY - cy;\\n\\n    //mat2 yzRot = Rot(min(1.15,  max(-0.25, -m.y + 0.5) * pi));\\n    mat2 yzRot = Rot(min(maxY,  max(minY, -m.y + 0.5 + sin(hopTime) * amp)) * pi);\\n    //mat2 yzRot = Rot((-m.y + 0.5) * pi);\\n    //mat2 yzRot = Rot(max(-0.08, -m.y + 0.5) * pi);\\n    ro.yz *= yzRot;\\n\\n    mat2 xzRot = Rot((-m.x + 0.5 + rotTime)* 7.0);\\n\\n    ro.xz *= xzRot;\\n\\n    vec3 lookAt = vec3(0, 2.5, 0);\\n\\n    vec3 rd = Camera(uv, ro, lookAt, 1.3);\\n\\n    // aproximated direction of the moon in our tabula-rasa.jpg env map\\n\\n    float angle = tau * 0.5875;\\n\\n    vec3 sunDir = normalize(vec3(cos(angle), 0.4, sin(angle)));\\n\\n    vec3 sunColor = vec3(4.5);\\n\\n    vec3 col = vec3(0,0,1);\\n\\n    opts o = opts(0.0);\\n\\n    vec2 result = rayMarch(ro, rd, o);\\n    float d = result.x;\\n    vec3 p = ro + rd * d;\\n    if (d < MAX_DIST) {\\n\\n        //vec3 lightPos = vec3(-40,20,0);\\n        vec3 norm = getNormal(p, o);\\n        float id = result.y;\\n\\n        int count = 0;\\n        while (id == 1.0 && count < mirrorLimit)\\n        {\\n            vec3 ref = reflect(rd, norm);\\n            result = rayMarch(p + ref * 0.00001, ref, o);\\n\\n            float d2 = result.x;\\n            vec3 p2 = p + ref * d2;\\n\\n            p = p2;\\n            rd = ref;\\n            d += d2;\\n\\n            if (d2 < MAX_DIST) {\\n                norm = getNormal(p, o);\\n                id = result.y;\\n            }\\n            else\\n            {\\n                count = mirrorLimit;\\n            }\\n            count++;\\n        }\\n\\n        if ( round(id) == 1.0 || count >= mirrorLimit)\\n        {\\n            col = getEnv(rd, false);\\n        }\\n        else if (round(id) < 5.0)\\n        {\\n\\n            // specular\\n            vec3 viewDir = normalize(rd);\\n            vec3 reflectDir = reflect(sunDir, norm);\\n\\n            // diffuse\\n            float diff = max(dot(norm, sunDir), 0.0);\\n\\n            vec3 ref = reflect(rd, norm);\\n\\n            vec3 tone = id == 2.0 ? pow(getEnv(rd, false), toLinearFactor) : getPaletteColor(id);\\n\\n            float shadow = softshadow(p, sunDir, 0.7, o);\\n\\n            vec3 refColor = pow(getEnv(rd, true), toLinearFactor) * 0.1;\\n\\n            vec3 diffuse = diff * tone * sunColor * shadow + refColor;\\n            float spec = pow(max(dot(viewDir, reflectDir), 0.0), u_shiny[int(id)]);\\n            vec3 specular = sunColor * spec * shadow;\\n            //col = applyFog((id == 2.0 ? diffuse : diffuse + specular), d, ro, rd, p);\\n            col = pow((id == 2.0 ? diffuse : diffuse + specular), toRGBFactor);\\n        }\\n        else\\n        {\\n            vec3 tone = getPaletteColor(id);\\n            col = tone * 5000.0/(d*d);\\n        }\\n\\n    }\\n    else\\n    {\\n        col = getEnv(rd, false);\\n    }\\n\\n    outColor = vec4(\\n        col,\\n        1.0\\n    );\\n\\n    //outColor = vec4(1,0,1,1);\\n}\\n\";"],"sourceRoot":""}